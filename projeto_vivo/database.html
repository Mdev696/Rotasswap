<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Hist√≥rico de Dados</title>
<style>
  body {
      font-family: Arial, sans-serif;
      margin: 20px;
  }
  form {
      margin: 20px 0;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
  }
  form input, form button {
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 6px;
  }
  table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 20px;
  }
  th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: left;
  }
  th {
      background-color: #0078d7;
      color: white;
  }
  tr:nth-child(even) {
      background-color: #f9f9f9;
  }
  #clearBtn {
      background-color: red;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
  }
  .action-btn {
      cursor: pointer;
      border: none;
      border-radius: 4px;
      padding: 5px 10px;
      color: white;
  }
  .edit-btn {
      background-color: #ffa500;
  }
  .delete-btn {
      background-color: #d9534f;
  }
</style>
</head>
<body>

<h2>üìã Hist√≥rico de Inser√ß√µes</h2> 
<a href="home.html">INICIO</a> 
<a href="pass.html">/SAIR</a>

<!-- Formul√°rio -->
<form id="addForm">
    <input type="text" id="uf" placeholder="UF" required>
    <input type="text" id="pontaA" placeholder="PONTA A" required>
    <input type="text" id="abordagemA" placeholder="ABORDAGEM (M)">
    <input type="text" id="pontaB" placeholder="PONTA B" required>
    <input type="text" id="abordagemB" placeholder="ABORDAGEM (M)">
    <input type="text" id="swap" placeholder="SWAP">
    <input type="text" id="designador" placeholder="DESIGNADOR">
    <input type="text" id="ots" placeholder="OTS">
    <input type="text" id="totalEnlace" placeholder="TOTAL ENLACE (M)">
    <input type="text" id="info" placeholder="INFORMA√á√ïES">
    <button type="submit">Adicionar Linha</button>
</form>

<!-- Bot√£o para limpar hist√≥rico -->
<button id="clearBtn">üóëÔ∏è Limpar Hist√≥rico</button>

<!-- Tabela -->
<table id="planilha">
    <tr>
        <th>UF</th>
        <th>PONTA A</th>
        <th>ABORDAGEM (M)</th>
        <th>PONTA B</th>
        <th>ABORDAGEM (M)</th>
        <th>SWAP</th>
        <th>DESIGNADOR</th>
        <th>OTS</th>
        <th>TOTAL ENLACE (M)</th>
        <th>INFORMA√á√ïES</th>
        <th>A√á√ïES</th>
    </tr>
</table>

<script>
const form = document.getElementById("addForm");
const table = document.getElementById("planilha");
const clearBtn = document.getElementById("clearBtn");
let editIndex = null; // para saber se estamos editando

// Adiciona uma linha √† tabela
function addRow(data, index = null) {
    const newRow = table.insertRow();
    Object.values(data).forEach(value => {
        const cell = newRow.insertCell();
        cell.innerText = value;
    });

    // Bot√µes de a√ß√£o
    const actions = newRow.insertCell();
    actions.innerHTML = `
        <button class="action-btn edit-btn">Editar</button>
        <button class="action-btn delete-btn">Excluir</button>
    `;

    // Evento editar
    actions.querySelector(".edit-btn").addEventListener("click", () => editRow(index ?? newRow.rowIndex - 1));
    // Evento excluir
    actions.querySelector(".delete-btn").addEventListener("click", () => deleteRow(index ?? newRow.rowIndex - 1));
}

// Carrega o hist√≥rico salvo
window.onload = () => {
    const savedData = JSON.parse(localStorage.getItem("historico")) || [];
    savedData.forEach((item, i) => addRow(item, i));
};

// Submiss√£o do formul√°rio
form.addEventListener("submit", (e) => {
    e.preventDefault();

    const newData = {
        uf: uf.value,
        pontaA: pontaA.value,
        abordagemA: abordagemA.value,
        pontaB: pontaB.value,
        abordagemB: abordagemB.value,
        swap: swap.value,
        designador: designador.value,
        ots: ots.value,
        totalEnlace: totalEnlace.value,
        info: info.value
    };

    const historico = JSON.parse(localStorage.getItem("historico")) || [];

    if (editIndex !== null) {
        // Atualiza registro existente
        historico[editIndex] = newData;
        localStorage.setItem("historico", JSON.stringify(historico));
        table.deleteRow(editIndex + 1); // +1 por causa do cabe√ßalho
        addRow(newData, editIndex);
        editIndex = null;
    } else {
        // Adiciona novo
        historico.push(newData);
        localStorage.setItem("historico", JSON.stringify(historico));
        addRow(newData, historico.length - 1);
    }

    form.reset();
});

// Fun√ß√£o editar
function editRow(index) {
    const historico = JSON.parse(localStorage.getItem("historico")) || [];
    const item = historico[index];
    for (const key in item) {
        document.getElementById(key).value = item[key];
    }
    editIndex = index;
}

// Fun√ß√£o excluir
function deleteRow(index) {
    if (!confirm("Deseja realmente excluir esta linha?")) return;
    const historico = JSON.parse(localStorage.getItem("historico")) || [];
    historico.splice(index, 1);
    localStorage.setItem("historico", JSON.stringify(historico));
    table.deleteRow(index + 1);
}

// Limpar hist√≥rico
clearBtn.addEventListener("click", () => {
    if (confirm("Tem certeza que deseja apagar todo o hist√≥rico?")) {
        localStorage.removeItem("historico");
        while (table.rows.length > 1) table.deleteRow(1);
    }
});
</script>

</body>
</html>
